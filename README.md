The solution of test task is basically a pseudo-realisation of an approach from this article:
https://arxiv.org/pdf/2504.09738v1